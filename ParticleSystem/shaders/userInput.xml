<project>
	<resources>
		<buffers>
			<buffer name="rocket_lifetimes" elements=512 type="float"/>
			<buffer name="rocketpositions" elements=512 type="vec4"/>
			<buffer name="rocket_velocities" elements=512 type="vec4"/>
			<buffer name="rocket_colors" elements=512 type="vec4"/>

			<buffer name="explosion_lifetimes" elements=512 type="float"/>
			<buffer name="explosion_positions" elements=512 type="vec4"/>
			<buffer name="explosion_velocities" elements=512 type="vec4"/>
			<buffer name="explosion_colors" elements=512 type="vec4"/>
		</buffers>
		<atomics>
			<atomic name="rocket_aliveParticles" value=0 />
			<atomic name="rocket_emissionAttempts" value=0/>

			<atomic name="explosion_aliveParticles" value=0 />
			<atomic name="explosion_emissionAttempts" value=0/>
		</atomics>
		<uniforms>
			<uniform name="rocket_maxParticles" type="float" value=10 />
			<uniform name="rocket_toCreate" type="float" value=1 />

			<uniform name="explosion_maxParticles" type="float" value=256 />
			<uniform name="explosion_toCreate" type="float" value=256 />
		</uniforms>
	</resources>

	<psystem name="rocket">
		<!--> position, rotation, scale: x: number y: number z: number <-->
		<position x=0 y=0 z=-1 />
		<rotation x=0 y=0 z=0 />
		<scale x=0 y=0 z=0 />
		<!--> lifetime: unit: "sec", "millisec";
						limit: number;
						looping: "true", "false" <-->
		<lifetime unit="sec" limit=10 looping="true"/>

		<!--> ------------------------------------------------------------- <-->
		<!--> GL PROGRAMS <-->
		<!--> ------------------------------------------------------------- <-->
		<emitter>
			<resources>
				<atomics>
					<atomic name="rocket_aliveParticles" />
					<atomic name="rocket_emissionAttempts" reset="true" />
				</atomics>
				<buffers>
					<buffer name="rocket_lifetimes" />
					<buffer name="rocketpositions" />
					<buffer name="rocket_velocities" />
					<buffer name="rocket_colors" />
				</buffers>
				<uniforms>
					<uniform name="rocket_maxParticles" />
					<uniform name="rocket_toCreate" />
				</uniforms>
			</resources>

			<files>
				<file path="shaders/fireworks/rocketEmitter.comp" />
			</files>
		</emitter>

		<updater>
			<resources>
				<atomics>
					<atomic name="rocket_aliveParticles" />
					<atomic name="rocket_emissionAttempts" />
				</atomics>
				<buffers>
					<buffer name="rocket_lifetimes" />
					<buffer name="rocketpositions" />
					<buffer name="rocket_velocities" />
					<buffer name="rocket_colors" />
				</buffers>
				<uniforms>
				</uniforms>
			</resources>

			<files>
				<file path="shaders/fireworks/rocketUpdater.comp" />
			</files>
		</updater>

		<renderer>
			<resources>
				<atomics>
				</atomics>
				<buffers>
					<buffer name="rocket_lifetimes" />
					<buffer name="rocketpositions"/>
					<buffer name="rocket_colors" />
				</buffers>
				<uniforms>
				</uniforms>
			</resources>

			<vertfiles>
				<file path="shaders/fireworks/rocketVertex.vert" />
			</vertfiles>
			<fragfiles>
				<file path="shaders/fireworks/rocketFrag.frag" />
			</fragfiles>
		</renderer>
	</psystem>

	<psystem name="explosion">
		<position x=0 y=1.5 z=-5 />
		<rotation x=0 y=0 z=0 />
		<scale x=0 y=0 z=0 />

		<lifetime unit="sec" limit=10 looping="true"/>

		<emitter>
			<resources>
				<atomics>
					<atomic name="explosion_aliveParticles" />
					<atomic name="explosion_emissionAttempts" reset="true" />
				</atomics>
				<buffers>
					<buffer name="explosion_lifetimes" />
					<buffer name="explosion_positions" />
					<buffer name="explosion_velocities" />
					<buffer name="explosion_colors" />
				</buffers>
				<uniforms>
					<uniform name="explosion_maxParticles" />
					<uniform name="explosion_toCreate" />
				</uniforms>
			</resources>

			<files>
				<file path="shaders/fireworks/explosionEmitter.comp" />
			</files>
		</emitter>

		<updater>
			<resources>
				<atomics>
					<atomic name="explosion_aliveParticles" />
					<atomic name="explosion_emissionAttempts" />
				</atomics>
				<buffers>
					<buffer name="explosion_lifetimes" />
					<buffer name="explosion_positions" />
					<buffer name="explosion_velocities" />
					<buffer name="explosion_colors" />
				</buffers>
				<uniforms>
				</uniforms>
			</resources>

			<files>
				<file path="shaders/fireworks/explosionUpdater.comp" />
			</files>
		</updater>

		<renderer>
			<resources>
				<atomics>
				</atomics>
				<buffers>
					<buffer name="explosion_lifetimes" />
					<buffer name="explosion_positions"/>
					<buffer name="explosion_colors" />
				</buffers>
				<uniforms>
				</uniforms>
			</resources>

			<vertfiles>
				<file path="shaders/fireworks/explosionVertex.vert" />
			</vertfiles>
			<fragfiles>
				<file path="shaders/fireworks/explosionFrag.frag" />
			</fragfiles>
		</renderer>
	</psystem>

</project>